<!doctype html>
<html lang="en">
 <head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cathedral Events - Past &amp; Upcoming</title>
  <script src="/_sdk/element_sdk.js"></script>
<script src="/_sdk/data_sdk.js"></script>

<style>@view-transition { navigation: auto; }</style>

<script src="https://cdn.tailwindcss.com"></script>

<!-- MUST LOAD BEFORE cms-loader -->
<script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>

<!-- Depends on js-yaml -->
<script src="/js/cms-loader.js"></script>
  <style>
    body {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
      font-family: 'Georgia', serif;
      color: #333;
      overflow-x: hidden;
      width: 100%;
      max-width: 100vw;
    }

    * {
      box-sizing: border-box;
    }

    html, body {
      height: 100%;
      overflow-x: hidden;
      width: 100%;
      max-width: 100vw;
    }

    /* Navigation */
    nav {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      width: 100%;
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(10px);
      z-index: 1000;
      padding: 1.25rem 5%;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }

    .nav-container {
      max-width: 1600px;
      margin: 0 auto;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 2rem;
    }

    .logo {
      font-size: 1.5rem;
      font-weight: bold;
      color: #C41E3A;
      white-space: nowrap;
      flex-shrink: 0;
    }

    .nav-links {
      display: flex;
      gap: clamp(0.5rem, 2vw, 2.5rem);
      list-style: none;
      margin: 0;
      padding: 0;
      align-items: center;
      flex-wrap: wrap;
      justify-content: center;
    }

    .nav-links li {
      white-space: nowrap;
    }

    .nav-links a {
      text-decoration: none;
      color: #333;
      font-weight: 500;
      transition: all 0.3s;
      padding: clamp(0.4rem, 1vw, 0.5rem) clamp(0.6rem, 1.5vw, 1rem);
      display: inline-block;
      border-radius: 8px;
      font-size: clamp(0.85rem, 1.5vw, 1rem);
    }

    .nav-links a:hover {
      color: #C41E3A;
      background: rgba(196, 30, 58, 0.05);
      transform: translateY(-2px);
    }

    /* Page Header */
    .page-header {
      width: 100%;
      background: linear-gradient(135deg, #C41E3A 0%, #8B1528 100%);
      color: white;
      padding: 8rem 5% 4rem 5%;
      text-align: center;
      margin-top: 4rem;
    }

    .page-header h1 {
      font-size: clamp(2.5rem, 5vw, 4rem);
      margin: 0 0 1rem 0;
      max-width: 1600px;
      margin-left: auto;
      margin-right: auto;
    }

    .page-header p {
      font-size: clamp(1.1rem, 2vw, 1.5rem);
      font-style: italic;
      margin: 0;
      opacity: 0.95;
      max-width: 1600px;
      margin-left: auto;
      margin-right: auto;
    }

    /* Mini Calendar Section */
    .mini-calendar-section {
      width: 100%;
      max-width: 100%;
      padding: 3rem 5%;
      background: white;
      border-bottom: 2px solid #FFB6C1;
      overflow-x: hidden;
    }

    .mini-calendar-container {
      max-width: 1200px;
      width: 100%;
      margin: 0 auto;
    }

    .calendar-title {
      font-size: clamp(1.8rem, 3vw, 2.5rem);
      color: #C41E3A;
      text-align: center;
      margin: 0 0 1.5rem 0;
      font-weight: bold;
    }

    .month-navigation {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 1.5rem;
      padding: 1rem 1.5rem;
      background: #f9f9f9;
      border-radius: 15px;
    }

    .month-nav-btn {
      background: #C41E3A;
      color: white;
      border: none;
      padding: 0.6rem 1.2rem;
      border-radius: 50px;
      font-size: 0.95rem;
      font-weight: 600;
      cursor: pointer;
      transition: all 0.3s;
      font-family: 'Georgia', serif;
    }

    .month-nav-btn:hover {
      background: #8B1528;
      transform: scale(1.05);
    }

    .current-month {
      font-size: 1.5rem;
      font-weight: bold;
      color: #C41E3A;
    }

    .calendar-grid {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: clamp(0.3rem, 0.8vw, 0.8rem);
      background: #f9f9f9;
      padding: clamp(1rem, 2vw, 2rem);
      border-radius: 15px;
      width: 100%;
      max-width: 100%;
    }

    .day-header {
      text-align: center;
      font-weight: bold;
      color: #C41E3A;
      padding: clamp(0.6rem, 1vw, 1rem) 0.25rem;
      font-size: clamp(0.85rem, 1.2vw, 1.1rem);
      border-bottom: 2px solid #FFB6C1;
    }
    
    /* --- MODIFIED: Base Calendar Day Style for Event Listing --- */
    .calendar-day {
      aspect-ratio: 1;
      /* Adjusted to column layout to stack day number and event list */
      display: flex;
      flex-direction: column; 
      align-items: center; 
      justify-content: flex-start; /* Default to top alignment for content stacking */
      padding: 0.4rem;
      border-radius: 8px;
      cursor: pointer;
      transition: all 0.3s;
      position: relative;
      background: white;
      min-height: clamp(50px, 6vw, 80px);
      font-size: clamp(0.9rem, 1.2vw, 1.2rem);
      overflow: hidden; /* Hide event name overflow if too many exist */
    }

    /* Re-center the number for days without events */
    .calendar-day:not(.has-event) {
        justify-content: center;
    }

    .calendar-day:hover {
      background: #FFB6C1;
      transform: scale(1.05);
    }

    .calendar-day.other-month {
      opacity: 0.3;
      cursor: default;
    }

    .calendar-day.other-month:hover {
      background: white;
      transform: none;
    }

    .calendar-day.today {
      background: #C41E3A;
      color: white;
      font-weight: bold;
    }

    .calendar-day.today:hover {
      background: #8B1528;
    }

    .calendar-day.has-event {
      background: linear-gradient(135deg, #FFB6C1 0%, #FFC0CB 100%);
      font-weight: 600;
    }

    .calendar-day.has-event:hover {
      background: linear-gradient(135deg, #FF99AA 0%, #FFB6C1 100%);
    }

    /* --- NEW STYLES for Event Names on Calendar Day --- */
    .calendar-day .day-number {
        font-weight: bold;
        font-size: 1.1em;
        padding-bottom: 0.1rem;
        line-height: 1;
    }

    .calendar-day .event-names-list {
      list-style: none;
      padding: 0;
      margin: 0.2rem 0 0 0;
      width: 100%;
      text-align: center;
      flex-grow: 1; 
      min-height: 0;
    }

    .calendar-day .event-names-list li {
      font-size: 0.65rem; /* Small font size for multiple events */
      line-height: 1.1;
      color: #C41E3A; /* Use Primary Color for event names */
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
      margin-top: 1px;
    }

    /* --- REMOVED: Event Indicator Dot (Replaced by Names) --- */
    .event-indicator {
      display: none; 
    }
    /* --- END OF CALENDAR ENHANCEMENT STYLES --- */


    /* Featured Events Grid Section */
    .featured-events-section {
      width: 100%;
      max-width: 100%;
      padding: 4rem 5%;
      background: #f9f9f9;
      overflow-x: hidden;
    }

    .featured-events-container {
      max-width: 1600px;
      width: 100%;
      margin: 0 auto;
    }

    .featured-events-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(320px, 1fr));
      gap: clamp(1.5rem, 2.5vw, 3rem);
    }

    .featured-event-card {
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      transition: all 0.3s;
      cursor: pointer;
      position: relative;
    }

    .featured-event-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 15px 40px rgba(196, 30, 58, 0.2);
    }

    .featured-event-image {
      width: 100%;
      height: clamp(250px, 20vw, 350px);
      object-fit: cover;
      background: linear-gradient(135deg, #FFB6C1, #FFC0CB);
    }

    .featured-event-badge {
      position: absolute;
      top: 1rem;
      left: 1rem;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-weight: bold;
      font-size: 0.85rem;
      text-transform: uppercase;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }

    .featured-event-badge.coming-soon {
      background: linear-gradient(135deg, #FFB6C1, #FFC0CB);
      color: #8B1528;
    }

    .featured-event-badge.previous {
      background: linear-gradient(135deg, #999, #666);
      color: white;
    }

    .featured-event-content {
      padding: clamp(1.25rem, 2vw, 2rem);
    }

    .featured-event-title {
      font-size: clamp(1.4rem, 2vw, 1.8rem);
      color: #C41E3A;
      margin: 0 0 0.75rem 0;
      font-weight: bold;
    }

    .featured-event-date {
      font-size: clamp(0.9rem, 1.2vw, 1.05rem);
      color: #666;
      margin-bottom: 0.5rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .featured-event-description {
      font-size: clamp(0.95rem, 1.2vw, 1.1rem);
      color: #555;
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    /* Events Sections */
    .events-section {
      width: 100%;
      max-width: 100%;
      padding: 4rem 5%;
      background: #f9f9f9;
      overflow-x: hidden;
    }

    .events-section:nth-child(even) {
      background: white;
    }

    .events-container {
      max-width: 1600px;
      width: 100%;
      margin: 0 auto;
    }

    .section-title {
      font-size: clamp(2rem, 4vw, 3rem);
      color: #C41E3A;
      text-align: center;
      margin: 0 0 3rem 0;
      position: relative;
      padding-bottom: 1rem;
      font-weight: bold;
    }

    .section-title::after {
      content: '';
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 100px;
      height: 3px;
      background: #FFB6C1;
    }

    .loading-state, .empty-state {
      text-align: center;
      padding: 3rem 2rem;
    }

    .loading-spinner {
      display: inline-block;
      width: 50px;
      height: 50px;
      border: 4px solid #FFB6C1;
      border-top-color: #C41E3A;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .loading-text, .empty-text {
      margin-top: 1rem;
      font-size: 1.2rem;
      color: #666;
    }

    /* Event Cards */
    .events-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
      gap: clamp(1.5rem, 2.5vw, 3rem);
    }

    .event-card {
      background: white;
      border-radius: 15px;
      overflow: hidden;
      box-shadow: 0 5px 20px rgba(0,0,0,0.1);
      transition: all 0.3s;
      cursor: pointer;
    }

    .event-card:hover {
      transform: translateY(-10px);
      box-shadow: 0 15px 40px rgba(196, 30, 58, 0.2);
    }

    .event-image {
      width: 100%;
      height: clamp(230px, 18vw, 320px);
      object-fit: cover;
      background: linear-gradient(135deg, #FFB6C1, #FFC0CB);
    }

    .event-date-badge {
      position: absolute;
      top: 1rem;
      right: 1rem;
      background: #C41E3A;
      color: white;
      padding: 0.75rem 1rem;
      border-radius: 10px;
      font-weight: bold;
      text-align: center;
      box-shadow: 0 4px 10px rgba(0,0,0,0.3);
    }

    .event-date-day {
      font-size: 1.8rem;
      line-height: 1;
    }

    .event-date-month {
      font-size: 0.9rem;
      text-transform: uppercase;
    }

    .event-content {
      padding: clamp(1.25rem, 2vw, 2rem);
      position: relative;
    }

    .event-category {
      display: inline-block;
      background: #FFB6C1;
      color: #8B1528;
      padding: 0.35rem 0.85rem;
      border-radius: 20px;
      font-size: clamp(0.8rem, 1vw, 0.95rem);
      font-weight: 600;
      margin-bottom: 0.75rem;
      text-transform: uppercase;
    }

    .event-title {
      font-size: clamp(1.4rem, 2vw, 1.8rem);
      color: #C41E3A;
      margin: 0 0 0.75rem 0;
      font-weight: bold;
    }

    .event-time {
      font-size: clamp(0.9rem, 1.2vw, 1.05rem);
      color: #666;
      margin-bottom: 0.75rem;
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .event-description {
      font-size: clamp(0.95rem, 1.2vw, 1.1rem);
      color: #555;
      line-height: 1.6;
      margin-bottom: 1rem;
    }

    .event-location {
      font-size: clamp(0.9rem, 1.2vw, 1.05rem);
      color: #666;
      display: flex;
      align-items: center;
      gap: 0.5rem;
      margin-bottom: 0.75rem;
    }

    .event-status {
      display: inline-block;
      padding: 0.5rem 1rem;
      border-radius: 8px;
      font-size: 0.9rem;
      font-weight: 600;
      margin-top: 0.5rem;
    }

    .event-status.completed {
      background: #e8f5e9;
      color: #2e7d32;
    }

    .event-status.upcoming {
      background: #fff3e0;
      color: #ef6c00;
    }

    /* Photo Carousel Section */
    .carousel-section {
      width: 100%;
      max-width: 100%;
      padding: 4rem 5%;
      background: white;
      overflow-x: hidden;
    }

    .carousel-container {
      max-width: 1800px;
      width: 100%;
      margin: 0 auto;
    }

    .carousel-wrapper {
      position: relative;
      overflow: hidden;
      border-radius: 20px;
      box-shadow: 0 10px 40px rgba(0,0,0,0.2);
      width: 100%;
      max-width: 100%;
    }

    .carousel-track {
      display: flex;
      transition: transform 0.5s ease-in-out;
      width: 100%;
    }

    .carousel-slide {
      min-width: 100%;
      height: clamp(450px, 40vw, 750px);
      position: relative;
    }

    .carousel-image {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .carousel-caption {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      color: white;
      padding: 3rem 2rem 2rem 2rem;
    }

    .carousel-caption-title {
      font-size: clamp(1.5rem, 3vw, 2.5rem);
      font-weight: bold;
      margin: 0 0 0.5rem 0;
    }

    .carousel-caption-date {
      font-size: clamp(1rem, 1.5vw, 1.3rem);
      opacity: 0.9;
      margin: 0;
    }

    .carousel-button {
      position: absolute;
      top: 50%;
      transform: translateY(-50%);
      background: rgba(196, 30, 58, 0.9);
      color: white;
      border: none;
      width: 60px;
      height: 60px;
      border-radius: 50%;
      font-size: 1.8rem;
      cursor: pointer;
      transition: all 0.3s;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    .carousel-button:hover {
      background: #C41E3A;
      transform: translateY(-50%) scale(1.1);
    }

    .carousel-button.prev {
      left: 2rem;
    }

    .carousel-button.next {
      right: 2rem;
    }

    .carousel-indicators {
      display: flex;
      justify-content: center;
      gap: 0.75rem;
      margin-top: 1.5rem;
    }

    .carousel-dot {
      width: 12px;
      height: 12px;
      border-radius: 50%;
      background: #ddd;
      cursor: pointer;
      transition: all 0.3s;
      border: none;
      padding: 0;
    }

    .carousel-dot.active {
      background: #C41E3A;
      width: 40px;
      border-radius: 6px;
    }

    .carousel-dot:hover {
      background: #FFB6C1;
    }

    /* Event Detail Popup */
    .event-popup {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: white;
      border-radius: 20px;
      box-shadow: 0 15px 50px rgba(0,0,0,0.3);
      z-index: 2000;
      max-width: 900px;
      width: 90%;
      max-height: 85%;
      overflow-y: auto;
    }

    .event-popup.active {
      display: block;
      animation: popupFadeIn 0.3s ease;
    }

    @keyframes popupFadeIn {
      from {
        opacity: 0;
        transform: translate(-50%, -45%);
      }
      to {
        opacity: 1;
        transform: translate(-50%, -50%);
      }
    }

    .popup-overlay {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.7);
      z-index: 1999;
    }

    .popup-overlay.active {
      display: block;
    }

    .popup-image {
      width: 100%;
      height: clamp(300px, 30vw, 450px);
      object-fit: cover;
      border-radius: 20px 20px 0 0;
    }

    .popup-content {
      padding: clamp(1.5rem, 3vw, 2.5rem);
    }

    .popup-header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
      margin-bottom: 1.5rem;
    }

    .popup-close {
      background: #C41E3A;
      color: white;
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      font-size: 1.5rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.3s;
      flex-shrink: 0;
    }

    .popup-close:hover {
      background: #8B1528;
      transform: rotate(90deg);
    }

    .popup-title {
      font-size: 2rem;
      color: #C41E3A;
      margin: 0;
      font-weight: bold;
      flex: 1;
      padding-right: 1rem;
    }

    .popup-details {
      margin-bottom: 1.5rem;
    }

    .popup-detail-item {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      margin-bottom: 0.75rem;
      font-size: 1.05rem;
      color: #555;
    }

    .popup-description {
      font-size: 1.05rem;
      color: #555;
      line-height: 1.7;
      margin-bottom: 1.5rem;
    }

    /* Footer */
    footer {
      width: 100%;
      background: #333;
      color: white;
      padding: 3rem 2rem;
      text-align: center;
    }

    .footer-content {
      max-width: 1200px;
      margin: 0 auto;
    }

    .footer-text {
      margin: 0.5rem 0;
    }

    /* Floating Social Media Buttons */
    .social-float-container {
      position: fixed;
      right: 2rem;
      bottom: 2rem;
      display: flex;
      flex-direction: column;
      gap: 1rem;
      z-index: 1500;
    }

    .social-float-btn {
      width: 60px;
      height: 60px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      text-decoration: none;
      font-size: 1.8rem;
      box-shadow: 0 4px 15px rgba(0,0,0,0.3);
      transition: all 0.3s;
      cursor: pointer;
      border: none;
      animation: pulse 2s infinite;
    }

    @keyframes pulse {
      0% {
        box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 0 0 rgba(255,255,255,0.7);
      }
      50% {
        box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 0 10px rgba(255,255,255,0);
      }
      100% {
        box-shadow: 0 4px 15px rgba(0,0,0,0.3), 0 0 0 0 rgba(255,255,255,0);
      }
    }

    .social-float-btn:hover {
      transform: scale(1.15);
      box-shadow: 0 6px 25px rgba(0,0,0,0.4);
      animation: none;
    }

    .social-float-btn.facebook {
      background: #1877F2;
    }

    .social-float-btn.facebook:hover {
      background: #145dbf;
    }

    .social-float-btn.instagram {
      background: linear-gradient(45deg, #f09433 0%, #e6683c 25%, #dc2743 50%, #cc2366 75%, #bc1888 100%);
    }

    .social-float-btn.whatsapp {
      background: #25D366;
    }

    .social-float-btn.whatsapp:hover {
      background: #1da851;
    }

    /* Responsive Design */
    @media (max-width: 991px) {
      .page-header h1 {
        font-size: 2.5rem;
      }

      .calendar-title {
        font-size: 1.6rem;
      }

      .section-title {
        font-size: 2rem;
      }

      .events-grid, .featured-events-grid {
        grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
        gap: 1.5rem;
      }

      .event-image, .featured-event-image {
        height: 220px;
      }

      .carousel-slide {
        height: 400px;
      }

      .carousel-button {
        width: 50px;
        height: 50px;
        font-size: 1.5rem;
      }

      .carousel-button.prev {
        left: 1rem;
      }

      .carousel-button.next {
        right: 1rem;
      }

      .carousel-caption {
        padding: 2rem 1.5rem 1.5rem 1.5rem;
      }

      .carousel-caption-title {
        font-size: 1.5rem;
      }

      .carousel-caption-date {
        font-size: 0.95rem;
      }
    }

    @media (max-width: 767px) {
      nav {
        padding: 0.875rem 1rem;
      }

      .nav-container {
        justify-content: center;
        flex-direction: column;
        gap: 0.5rem;
      }

      .logo {
        font-size: 1.2rem;
      }

      .nav-links {
        gap: 0.75rem;
        font-size: 0.85rem;
      }

      .page-header {
        padding: 5rem 1.5rem 2.5rem 1.5rem;
        margin-top: 4rem;
      }

      .page-header h1 {
        font-size: 2.2rem;
      }

      .page-header p {
        font-size: 1.05rem;
      }

      .mini-calendar-section, .events-section, .carousel-section, .featured-events-section {
        padding: 2.5rem 1rem;
      }

      .calendar-title {
        font-size: 1.5rem;
      }

      .section-title {
        font-size: 1.9rem;
      }

      .calendar-grid {
        gap: 0.3rem;
        padding: 0.75rem;
      }

      .day-header {
        font-size: 0.75rem;
        padding: 0.6rem 0.2rem;
      }

      .calendar-day {
        /* ADJUSTMENT: Increased min-height to better accommodate the event names on mobile */
        min-height: 60px;
        font-size: 0.85rem;
      }

      .events-grid, .featured-events-grid {
        grid-template-columns: 1fr;
      }

      .event-image, .featured-event-image {
        height: 200px;
      }

      .event-content, .featured-event-content {
        padding: 1.25rem;
      }

      .event-title, .featured-event-title {
        font-size: 1.4rem;
      }

      .popup-image {
        height: 250px;
      }

      .popup-content {
        padding: 1.5rem;
      }

      .popup-title {
        font-size: 1.6rem;
      }

      .carousel-slide {
        height: 350px;
      }

      .carousel-button {
        width: 40px;
        height: 40px;
        font-size: 1.3rem;
      }

      .carousel-button.prev {
        left: 0.5rem;
      }

      .carousel-button.next {
        right: 0.5rem;
      }

      .carousel-caption {
        padding: 1.5rem 1rem 1rem 1rem;
      }

      .carousel-caption-title {
        font-size: 1.3rem;
      }

      .carousel-caption-date {
        font-size: 0.85rem;
      }
    }

    @media (max-width: 479px) {
      .logo {
        font-size: 1rem;
      }

      .page-header {
        padding: 4rem 0.75rem 1.75rem 0.75rem;
      }

      .page-header h1 {
        font-size: 1.6rem;
      }

      .page-header p {
        font-size: 0.9rem;
      }

      .mini-calendar-section, .carousel-section, .featured-events-section {
        padding: 2rem 0.75rem;
      }

      .calendar-title {
        font-size: 1.3rem;
      }

      .month-navigation {
        padding: 0.75rem 1rem;
      }

      .current-month {
        font-size: 1.2rem;
      }

      .month-nav-btn {
        padding: 0.5rem 1rem;
        font-size: 0.85rem;
      }

      .section-title {
        font-size: 1.5rem;
      }

      .event-date-badge {
        padding: 0.6rem 0.8rem;
      }

      .event-date-day {
        font-size: 1.5rem;
      }

      .event-date-month {
        font-size: 0.8rem;
      }

      .event-title, .featured-event-title {
        font-size: 1.3rem;
      }

      .popup-title {
        font-size: 1.4rem;
      }

      .carousel-slide {
        height: 300px;
      }

      .carousel-caption-title {
        font-size: 1.1rem;
      }

      .carousel-caption-date {
        font-size: 0.8rem;
      }

      .carousel-dot {
        width: 10px;
        height: 10px;
      }

      .carousel-dot.active {
        width: 30px;
      }

      .social-float-container {
        right: 1rem;
        bottom: 1rem;
        gap: 0.75rem;
      }

      .social-float-btn {
        width: 50px;
        height: 50px;
        font-size: 1.5rem;
      }
    }
  </style>
  
 </head>
 <body>
  <nav>
   <div class="nav-container">
    <div class="logo">
     St. Columba's Catholic Church
    </div>
    <ul class="nav-links">
    <li><a href="index.html">Home</a></li>
     <li><a href="gallery.html">Gallery</a></li>
     <li><a href="community.html">Community</a></li>
     <li><a href="calendar.html">Calendar</a></li>
    </ul>
   </div>
  </nav><!-- Floating Social Media Buttons -->
  <div class="social-float-container"><a href="https://facebook.com/stmaryscathedral" target="_blank" rel="noopener noreferrer" class="social-float-btn facebook" aria-label="Visit our Facebook page">
    <svg viewbox="0 0 24 24" width="28" height="28" fill="currentColor"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z" />
    </svg></a> <a href="https://instagram.com/stmaryscathedral" target="_blank" rel="noopener noreferrer" class="social-float-btn instagram" aria-label="Visit our Instagram page">
    <svg viewbox="0 0 24 24" width="28" height="28" fill="currentColor"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zm0-2.163c-3.259 0-3.667.014-4.947.072-4.358.2-6.78 2.618-6.98 6.98-.059 1.281-.073 1.689-.073 4.948 0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98-1.281-.059-1.69-.073-4.949-.073zm0 5.838c-3.403 0-6.162 2.759-6.162 6.162s2.759 6.163 6.162 6.163 6.162-2.759 6.162-6.163c0-3.403-2.759-6.162-6.162-6.162zm0 10.162c-2.209 0-4-1.79-4-4 0-2.209 1.791-4 4-4s4 1.791 4 4c0 2.21-1.791 4-4 4zm6.406-11.845c-.796 0-1.441.645-1.441 1.44s.645 1.44 1.441 1.44c.795 0 1.439-.645 1.439-1.44s-.644-1.44-1.439-1.44z" />
    </svg></a> <a href="https://wa.me/15551234567" target="_blank" rel="noopener noreferrer" class="social-float-btn whatsapp" aria-label="Contact us on WhatsApp">
    <svg viewbox="0 0 24 24" width="28" height="28" fill="currentColor"><path d="M17.472 14.382c-.297-.149-1.758-.867-2.03-.967-.273-.099-.471-.148-.67.15-.197.297-.767.966-.94 1.164-.173.199-.347.223-.644.075-.297-.15-1.255-.463-2.39-1.475-.883-.788-1.48-1.761-1.653-2.059-.173-.297-.018-.458.13-.606.134-.133.298-.347.446-.52.149-.174.198-.298.298-.497.099-.198.05-.371-.025-.52-.075-.149-.669-1.612-.916-2.207-.242-.579-.487-.5-.669-.51-.173-.008-.371-.01-.57-.01-.198 0-.52.074-.792.372-.272.297-1.04 1.016-1.04 2.479 0 1.462 1.065 2.875 1.213 3.074.149.198 2.096 3.2 5.077 4.487.709.306 1.262.489 1.694.625.712.227 1.36.195 1.871.118.571-.085 1.758-.719 2.006-1.413.248-.694.248-1.289.173-1.413-.074-.124-.272-.198-.57-.347m-5.421 7.403h-.004a9.87 9.87 0 01-5.031-1.378l-.361-.214-3.741.982.998-3.648-.235-.374a9.86 9.86 0 01-1.51-5.26c.001-5.45 4.436-9.884 9.888-9.884 2.64 0 5.122 1.03 6.988 2.898a9.825 9.825 0 012.893 6.994c-.003 5.45-4.437 9.884-9.885 9.884m8.413-18.297A11.815 11.815 0 0012.05 0C5.495 0 .16 5.335.157 11.892c0 2.096.547 4.142 1.588 5.945L.057 24l6.305-1.654a11.882 11.882 0 005.683 1.448h.005c6.554 0 11.89-5.335 11.893-11.893a11.821 11.821 0 00-3.48-8.413Z" />
    </svg></a>
  </div>
  <header class="page-header">
   <h1 id="pageTitle">Cathedral Events</h1>
   <p id="pageSubtitle">Celebrating Our Faith Through Community Gatherings</p>
  </header><!-- Mini Calendar -->
  <section class="mini-calendar-section">
   <div class="mini-calendar-container">
    <h2 class="calendar-title">ğŸ“… Events Calendar</h2>
    <div class="month-navigation"><button class="month-nav-btn" id="prevMonth">â† Previous</button>
     <div class="current-month" id="currentMonth"></div><button class="month-nav-btn" id="nextMonth">Next â†’</button>
    </div>
    <div class="calendar-grid">
     <div class="day-header">
      Sun
     </div>
     <div class="day-header">
      Mon
     </div>
     <div class="day-header">
      Tue
     </div>
     <div class="day-header">
      Wed
     </div>
     <div class="day-header">
      Thu
     </div>
     <div class="day-header">
      Fri
     </div>
     <div class="day-header">
      Sat
     </div>
     <div id="calendarDays" style="grid-column: 1 / -1; display: grid; grid-template-columns: repeat(7, 1fr); gap: 0.4rem;"></div>
    </div>
   </div>
  </section><!-- Featured Events from CMS (Coming Soon + Previous Events) -->
  <section class="featured-events-section">
   <div class="featured-events-container">
    <h2 class="section-title" id="featuredSectionTitle">Featured Events</h2>
    <div id="featuredEventsContainer">
     <div class="loading-state">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading featured events...</p>
     </div>
    </div>
   </div>
  </section><!-- Upcoming Events -->
  <section class="events-section">
   <div class="events-container">
    <h2 class="section-title" id="upcomingSectionTitle">Upcoming Events</h2>
    <div id="upcomingEventsContainer">
     <div class="loading-state">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading upcoming events...</p>
     </div>
    </div>
   </div>
  </section><!-- Past Events -->
  <section class="events-section">
   <div class="events-container">
    <h2 class="section-title" id="pastSectionTitle">Past Events</h2>
    <div id="pastEventsContainer">
     <div class="loading-state">
      <div class="loading-spinner"></div>
      <p class="loading-text">Loading past events...</p>
     </div>
    </div>
   </div>
  </section><!-- Photo Carousel -->
  <section class="carousel-section">
   <div class="carousel-container">
    <h2 class="section-title">Event Memories</h2>
    <div class="carousel-wrapper">
     <div class="carousel-track" id="carouselTrack"></div><button class="carousel-button prev" id="carouselPrev">â€¹</button> <button class="carousel-button next" id="carouselNext">â€º</button>
    </div>
    <div class="carousel-indicators" id="carouselIndicators"></div>
   </div>
  </section><!-- Event Detail Popup -->
  <div class="popup-overlay" id="popupOverlay"></div>
  <div class="event-popup" id="eventPopup"><img class="popup-image" id="popupImage" src="" alt="">
   <div class="popup-content">
    <div class="popup-header">
     <h2 class="popup-title" id="popupTitle"></h2><button class="popup-close" id="popupClose">Ã—</button>
    </div>
    <div class="popup-details" id="popupDetails"></div>
    <p class="popup-description" id="popupDescription"></p>
   </div>
  </div>
  <footer>
   <div class="footer-content">
    <p class="footer-text">St. Columba's Catholic Church, Capital Park, Pretoria</p>
<p class="footer-text">261 Steve Biko Road | P.O. Box 23090, Gezina 0031 </p>
<p class="footer-text">Â© 2025 All Rights Reserved</p>
   </div>
  </footer>
  <script>
Â  Â  const defaultConfig = {
Â  Â  Â  page_title: "Cathedral Events",
Â  Â  Â  page_subtitle: "Celebrating Our Faith Through Community Gatherings",
Â  Â  Â  featured_section_title: "Featured Events",
Â  Â  Â  upcoming_section_title: "Upcoming Events",
Â  Â  Â  past_section_title: "Past Events",
Â  Â  Â  background_color: "#f9f9f9",
Â  Â  Â  surface_color: "#FFFFFF",
Â  Â  Â  text_color: "#333333",
Â  Â  Â  primary_action_color: "#C41E3A",
Â  Â  Â  secondary_action_color: "#FFB6C1",
Â  Â  Â  font_family: "Georgia",
Â  Â  Â  font_size: 16
Â  Â  };

Â  Â  // ===== DECAP CMS (Netlify CMS) CONFIGURATION (Placeholder) =====
Â  Â  

Â  Â  let currentDate = new Date();
Â  Â  let currentMonth = currentDate.getMonth();
Â  Â  let currentYear = currentDate.getFullYear();
Â  Â  let eventsData = [];
Â  Â  let carouselImages = [];
Â  Â  let currentSlide = 0;

Â  Â  const months = ['January', 'February', 'March', 'April', 'May', 'June', 
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  'July', 'August', 'September', 'October', 'November', 'December'];

Â  Â  // ===== DECAP CMS INTEGRATION =====

Â  Â  // Main fetch function with fallback to mock data
Â  Â  async function fetchEventsFromCMS() {
Â  Â  Â  Â  try {
Â  Â  Â  Â  Â  Â  // Use the same JSON path as generated by generator.js
Â  Â  Â  Â  Â  Â  const response = await fetch('./public/calendar.json');
Â  Â  Â  Â  Â  Â  if (!response.ok) {
Â  Â  Â  Â  Â  Â  Â  Â  throw new Error(`HTTP error! status: ${response.status}`);
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  const items = await response.json(); // Array of { title, date, body, etc. }

Â  Â  Â  Â  Â  Â  // normalize items -> eventsData
Â  Â  Â  Â  Â  Â  eventsData = items.map(ev => {
Â  Â  Â  Â  Â  Â  Â  Â  const data = ev; // Item is already flattened by generator.js
Â  Â  Â  Â  Â  Â  Â  Â  const slug = data.filename ? data.filename.replace('.md', '') : (data.title ? String(data.title).toLowerCase().trim().replace(/\s+/g,'-').replace(/[^a-z0-9\-]/g,'') : '');

Â  Â  Â  Â  Â  Â  Â  Â  // image: prefer 'image' field, fallback to first carousel image
Â  Â  Â  Â  Â  Â  Â  Â  let image = data.image || '';
Â  Â  Â  Â  Â  Â  Â  Â  if (!image && Array.isArray(data.carousel) && data.carousel.length > 0) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  image = data.carousel[0].img || data.carousel[0].url || '';
Â  Â  Â  Â  Â  Â  Â  Â  }

Â  Â  Â  Â  Â  Â  Â  Â  // description: body is the markdown content
Â  Â  Â  Â  Â  Â  Â  Â  const description = data.body || '';

                // --- FIX: COMBINE DATE AND TIME FOR ACCURATE STATUS CHECK ---
                const eventDate = data.date;
                // Default time to midnight (00:00) if not specified to ensure past events are correctly marked
                const eventTime = data.time || "00:00"; 

                // Create a full ISO-style DateTime string (e.g., "2025-01-01T18:00:00")
                const fullDateTimeString = eventDate ? `${eventDate}T${eventTime}:00` : null; 
                
                let status = "past";
                if (fullDateTimeString) {
                    const eventDateTime = new Date(fullDateTimeString);
                    // If the event time is now or in the future, mark as upcoming
                    if (eventDateTime >= new Date()) {
                        status = "upcoming";
                    }
                }
                // --- END OF FIX ---

Â  Â  Â  Â  Â  Â  Â  Â  // category, time, location map directly from JSON
Â  Â  Â  Â  Â  Â  Â  Â  return {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  id: slug,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  title: data.title || "Untitled Event",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  date: eventDate || "",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  time: eventTime || "",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  category: data.category || "General",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  location: data.location || "",
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  description,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  image,
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  // Note: Your generator.js doesn't support the nested 'carousel' structure naturally, but preserving the client logic here:
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  carousel: Array.isArray(data.carousel) ? data.carousel.map(c => ({ img: c.img || c.url || '', caption: c.caption || '' })) : [],
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  status: status // Use the newly calculated status
Â  Â  Â  Â  Â  Â  Â  Â  };
Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  // build carouselImages array for the page carousel
Â  Â  Â  Â  Â  Â  carouselImages = eventsData
Â  Â  Â  Â  Â  Â  Â  Â  .flatMap(ev => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  const list = [];
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (ev.image) list.push({ url: ev.image, title: ev.title, date: ev.date });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (Array.isArray(ev.carousel)) {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  ev.carousel.forEach(ci => {
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  if (ci.img) list.push({ url: ci.img, title: ev.title, date: ev.date, caption: ci.caption });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  });
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  return list;
Â  Â  Â  Â  Â  Â  Â  Â  });

Â  Â  Â  Â  Â  Â  return eventsData;
Â  Â  Â  Â  } catch (err) {
Â  Â  Â  Â  Â  Â  console.error("Error loading events from CMS:", err);
Â  Â  Â  Â  Â  Â  eventsData = []; // Clear data on error
Â  Â  Â  Â  Â  Â  // Display an error message in the loading containers
Â  Â  Â  Â  Â  Â  document.getElementById('featuredEventsContainer').innerHTML = '<p class="empty-text">Failed to load featured events.</p>';
Â  Â  Â  Â  Â  Â  document.getElementById('upcomingEventsContainer').innerHTML = '<p class="empty-text">Failed to load upcoming events.</p>';
Â  Â  Â  Â  Â  Â  document.getElementById('pastEventsContainer').innerHTML = '<p class="empty-text">Failed to load past events.</p>';
Â  Â  Â  Â  Â  Â  return [];
Â  Â  Â  Â  }
Â  Â  }


Â  Â  function getEventsForDate(date) {
Â  Â  Â  const dateStr = date.toISOString().split('T')[0];
Â  Â  Â  return eventsData.filter(event => event.date === dateStr);
Â  Â  }

    // --- ENHANCEMENT 1: Update renderCalendar to pass event data ---
Â  Â  function renderCalendar() {
Â  Â  Â  const firstDay = new Date(currentYear, currentMonth, 1).getDay();
Â  Â  Â  const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
Â  Â  Â  const daysInPrevMonth = new Date(currentYear, currentMonth, 0).getDate();
Â  Â  Â  
Â  Â  Â  const calendarDays = document.getElementById('calendarDays');
Â  Â  Â  calendarDays.innerHTML = '';

Â  Â  Â  const today = new Date();
Â  Â  Â  const isCurrentMonth = today.getMonth() === currentMonth && today.getFullYear() === currentYear;
Â  Â  Â  const todayDate = today.getDate();

Â  Â  Â  for (let i = firstDay - 1; i >= 0; i--) {
Â  Â  Â  Â  // Pass empty array for days in previous month
Â  Â  Â  Â  const dayDiv = createDayElement(daysInPrevMonth - i, true, false, []);
Â  Â  Â  Â  calendarDays.appendChild(dayDiv);
Â  Â  Â  }

Â  Â  Â  for (let day = 1; day <= daysInMonth; day++) {
Â  Â  Â  Â  const isToday = isCurrentMonth && day === todayDate;
Â  Â  Â  Â  const date = new Date(currentYear, currentMonth, day);
Â  Â  Â  Â  const events = getEventsForDate(date);
Â  Â  Â  Â  
Â  Â  Â  Â  // Pass the list of events for the current day
Â  Â  Â  Â  const dayDiv = createDayElement(day, false, isToday, events);
Â  Â  Â  Â  
Â  Â  Â  Â  if (events.length > 0) {
Â  Â  Â  Â  Â  dayDiv.addEventListener('click', () => scrollToEvent(events[0]));
Â  Â  Â  Â  }
Â  Â  Â  Â  calendarDays.appendChild(dayDiv);
Â  Â  Â  }

Â  Â  Â  const totalCells = calendarDays.children.length;
Â  Â  Â  const remainingCells = 42 - totalCells;
Â  Â  Â  for (let day = 1; day <= remainingCells; day++) {
Â  Â  Â  Â  // Pass empty array for days in next month
Â  Â  Â  Â  const dayDiv = createDayElement(day, true, false, []);
Â  Â  Â  Â  calendarDays.appendChild(dayDiv);
Â  Â  Â  }

Â  Â  Â  document.getElementById('currentMonth').textContent = `${months[currentMonth]} ${currentYear}`;
Â  Â  }

    // --- ENHANCEMENT 2: Update createDayElement for event names and hover ---
Â  Â  function createDayElement(day, isOtherMonth, isToday, events) {
    const hasEvent = events.length > 0;
    const dayDiv = document.createElement('div');
    dayDiv.className = 'calendar-day';
    
    // 1. Determine and add all necessary classes
    if (isOtherMonth) {
        dayDiv.classList.add('other-month');
    } 
    
    if (isToday) {
        dayDiv.classList.add('today');
    }
    
    // Add has-event class only if there are events and it's not an 'other-month' day
    if (hasEvent && !isOtherMonth) {
        dayDiv.classList.add('has-event');
    }

    // 2. Build the Event List HTML
    let eventListHTML = '';
    
    if (hasEvent && !isOtherMonth) {
        // Limit to 2 events to prevent cell overflow
        const visibleEvents = events.slice(0, 2); 
        
        // Map the event titles to <li> elements
        const listItems = visibleEvents.map(event => `<li>${event.title}</li>`).join('');
        
        eventListHTML = `<ul class="event-names-list">${listItems}</ul>`;
        
        // Set the native browser tooltip (using ALL events)
        const eventTitlesForTooltip = events.map(event => `${event.title} (${event.time})`);
        dayDiv.title = eventTitlesForTooltip.join('\n'); 
    }

    // 3. Use a single assignment to build the final nested HTML structure
    dayDiv.innerHTML = `
        <div class="day-number">${day}</div>
        ${eventListHTML}
    `;

    return dayDiv;
}

Â  Â  function renderFeaturedEvents() {
Â  Â  Â  // The status property (upcoming/past) is now accurate due to the fix in fetchEventsFromCMS
Â  Â  Â  const upcomingFeatured = eventsData
Â  Â  Â  Â  .filter(event => event.status === 'upcoming')
Â  Â  Â  Â  .sort((a, b) => new Date(a.date) - new Date(b.date))
Â  Â  Â  Â  .slice(0, 3);

Â  Â  Â  const pastFeatured = eventsData
Â  Â  Â  Â  .filter(event => event.status === 'past')
Â  Â  Â  Â  .sort((a, b) => new Date(b.date) - new Date(a.date))
Â  Â  Â  Â  .slice(0, 3);

Â  Â  Â  const featured = [...upcomingFeatured, ...pastFeatured];
Â  Â  Â  
Â  Â  Â  const container = document.getElementById('featuredEventsContainer');

Â  Â  Â  if (featured.length === 0) {
Â  Â  Â  Â  container.innerHTML = `
Â  Â  Â  Â  Â  <div class="empty-state">
Â  Â  Â  Â  Â  Â  <p class="empty-text">No featured events at this time.</p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  const grid = document.createElement('div');
Â  Â  Â  grid.className = 'featured-events-grid';

Â  Â  Â  featured.forEach(event => {
Â  Â  Â  Â  const card = createFeaturedEventCard(event);
Â  Â  Â  Â  grid.appendChild(card);
Â  Â  Â  });

Â  Â  Â  container.innerHTML = '';
Â  Â  Â  container.appendChild(grid);
Â  Â  }

Â  Â  function createFeaturedEventCard(event) {
Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  card.className = 'featured-event-card';
Â  Â  Â  card.addEventListener('click', () => showEventDetails(event));

Â  Â  Â  const eventDate = new Date(event.date);
Â  Â  Â  const isPast = event.status === 'past'; // Rely on the accurate status field
Â  Â  Â  const badgeText = isPast ? 'Previous Event' : 'Coming Soon';
Â  Â  Â  const badgeClass = isPast ? 'previous' : 'coming-soon';

Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  <div style="position: relative;">
Â  Â  Â  Â  Â  <img class="featured-event-image" src="${event.image}" alt="${event.title}" onerror="this.style.display='none';">
Â  Â  Â  Â  Â  <div class="featured-event-badge ${badgeClass}">${badgeText}</div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="featured-event-content">
Â  Â  Â  Â  Â  <h3 class="featured-event-title">${event.title}</h3>
Â  Â  Â  Â  Â  <div class="featured-event-date">ğŸ“… ${eventDate.toLocaleDateString('en-US', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}</div>
Â  Â  Â  Â  Â  <div class="featured-event-date">ğŸ• ${event.time}</div>
Â  Â  Â  Â  Â  <p class="featured-event-description">${event.description.substring(0, 120)}...</p>
Â  Â  Â  Â  </div>
Â  Â  Â  `;

Â  Â  Â  return card;
Â  Â  }

Â  Â  function renderEvents() {
Â  Â  Â  // Filter based on the accurate status property
Â  Â  Â  const upcomingEvents = eventsData
Â  Â  Â  Â  .filter(event => event.status === 'upcoming')
Â  Â  Â  Â  .sort((a, b) => new Date(a.date) - new Date(b.date)); // Sort ascending

Â  Â  Â  const pastEvents = eventsData
Â  Â  Â  Â  .filter(event => event.status === 'past')
Â  Â  Â  Â  .sort((a, b) => new Date(b.date) - new Date(a.date)); // Sort descending

Â  Â  Â  renderEventSection('upcomingEventsContainer', upcomingEvents, 'upcoming');
Â  Â  Â  renderEventSection('pastEventsContainer', pastEvents, 'past');
Â  Â  }

Â  Â  function renderEventSection(containerId, events, type) {
Â  Â  Â  const container = document.getElementById(containerId);
Â  Â  Â  
Â  Â  Â  if (events.length === 0) {
Â  Â  Â  Â  container.innerHTML = `
Â  Â  Â  Â  Â  <div class="empty-state">
Â  Â  Â  Â  Â  Â  <p class="empty-text">No ${type} events at this time.</p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  const grid = document.createElement('div');
Â  Â  Â  grid.className = 'events-grid';

Â  Â  Â  events.forEach(event => {
Â  Â  Â  Â  const card = createEventCard(event);
Â  Â  Â  Â  grid.appendChild(card);
Â  Â  Â  });

Â  Â  Â  container.innerHTML = '';
Â  Â  Â  container.appendChild(grid);
Â  Â  }

Â  Â  function createEventCard(event) {
Â  Â  Â  const card = document.createElement('div');
Â  Â  Â  card.className = 'event-card';
Â  Â  Â  card.addEventListener('click', () => showEventDetails(event));

Â  Â  Â  const eventDate = new Date(event.date);
Â  Â  Â  const day = eventDate.getDate();
Â  Â  Â  const month = months[eventDate.getMonth()].substring(0, 3);

Â  Â  Â  card.innerHTML = `
Â  Â  Â  Â  <div style="position: relative;">
Â  Â  Â  Â  Â  <img class="event-image" src="${event.image}" alt="${event.title}" onerror="this.style.display='none';">
Â  Â  Â  Â  Â  <div class="event-date-badge">
Â  Â  Â  Â  Â  Â  <div class="event-date-day">${day}</div>
Â  Â  Â  Â  Â  Â  <div class="event-date-month">${month}</div>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  </div>
Â  Â  Â  Â  <div class="event-content">
Â  Â  Â  Â  Â  <span class="event-category">${event.category}</span>
Â  Â  Â  Â  Â  <h3 class="event-title">${event.title}</h3>
Â  Â  Â  Â  Â  <div class="event-time">ğŸ• ${event.time}</div>
Â  Â  Â  Â  Â  <div class="event-location">ğŸ“ ${event.location}</div>
Â  Â  Â  Â  Â  <p class="event-description">${event.description.substring(0, 120)}...</p>
Â  Â  Â  Â  Â  <span class="event-status ${event.status}">${event.status === 'upcoming' ? 'Upcoming' : 'Completed'}</span>
Â  Â  Â  Â  </div>
Â  Â  Â  `;

Â  Â  Â  return card;
Â  Â  }

Â  Â  // Carousel Functions
Â  Â  function initCarousel() {
Â  Â  Â  if (carouselImages.length === 0) {
Â  Â  Â  Â  document.querySelector('.carousel-section').style.display = 'none';
Â  Â  Â  Â  return;
Â  Â  Â  }

Â  Â  Â  const track = document.getElementById('carouselTrack');
Â  Â  Â  const indicators = document.getElementById('carouselIndicators');

Â  Â  Â  carouselImages.forEach((img, index) => {
Â  Â  Â  Â  const slide = document.createElement('div');
Â  Â  Â  Â  slide.className = 'carousel-slide';
Â  Â  Â  Â  
Â  Â  Â  Â  const eventDate = new Date(img.date);
Â  Â  Â  Â  const formattedDate = eventDate.toLocaleDateString('en-US', { 
Â  Â  Â  Â  Â  year: 'numeric', 
Â  Â  Â  Â  Â  month: 'long', 
Â  Â  Â  Â  Â  day: 'numeric' 
Â  Â  Â  Â  });

Â  Â  Â  Â  slide.innerHTML = `
Â  Â  Â  Â  Â  <img class="carousel-image" src="${img.url}" alt="${img.title}" onerror="this.style.display='none';">
Â  Â  Â  Â  Â  <div class="carousel-caption">
Â  Â  Â  Â  Â  Â  <h3 class="carousel-caption-title">${img.title}</h3>
Â  Â  Â  Â  Â  Â  <p class="carousel-caption-date">${formattedDate}</p>
Â  Â  Â  Â  Â  </div>
Â  Â  Â  Â  `;
Â  Â  Â  Â  track.appendChild(slide);

Â  Â  Â  Â  const dot = document.createElement('button');
Â  Â  Â  Â  dot.className = 'carousel-dot';
Â  Â  Â  Â  if (index === 0) dot.classList.add('active');
Â  Â  Â  Â  dot.addEventListener('click', () => goToSlide(index));
Â  Â  Â  Â  indicators.appendChild(dot);
Â  Â  Â  });

Â  Â  Â  updateCarousel();
Â  Â  }

Â  Â  function updateCarousel() {
Â  Â  Â  const track = document.getElementById('carouselTrack');
Â  Â  Â  const dots = document.querySelectorAll('.carousel-dot');
Â  Â  Â  
Â  Â  Â  track.style.transform = `translateX(-${currentSlide * 100}%)`;
Â  Â  Â  
Â  Â  Â  dots.forEach((dot, index) => {
Â  Â  Â  Â  dot.classList.toggle('active', index === currentSlide);
Â  Â  Â  });
Â  Â  }

Â  Â  function nextSlide() {
Â  Â  Â  currentSlide = (currentSlide + 1) % carouselImages.length;
Â  Â  Â  updateCarousel();
Â  Â  }

Â  Â  function prevSlide() {
Â  Â  Â  currentSlide = (currentSlide - 1 + carouselImages.length) % carouselImages.length;
Â  Â  Â  updateCarousel();
Â  Â  }

Â  Â  function goToSlide(index) {
Â  Â  Â  currentSlide = index;
Â  Â  Â  updateCarousel();
Â  Â  }

Â  Â  function showEventDetails(event) {
Â  Â  Â  const popup = document.getElementById('eventPopup');
Â  Â  Â  const overlay = document.getElementById('popupOverlay');

Â  Â  Â  document.getElementById('popupImage').src = event.image;
Â  Â  Â  document.à®•à¯à®•à®¾à®°document.getElementById('popupTitle').textContent = event.title;
Â  Â  Â  
Â  Â  Â  const eventDate = new Date(event.date);
Â  Â  Â  const formattedDate = eventDate.toLocaleDateString('en-US', { 
Â  Â  Â  Â  weekday: 'long', 
Â  Â  Â  Â  year: 'numeric', 
Â  Â  Â  Â  month: 'long', 
Â  Â  Â  Â  day: 'numeric' 
Â  Â  Â  });

Â  Â  Â  document.getElementById('popupDetails').innerHTML = `
Â  Â  Â  Â  <div class="popup-detail-item"><strong>ğŸ“… Date:</strong> ${formattedDate}</div>
Â  Â  Â  Â  <div class="popup-detail-item"><strong>ğŸ• Time:</strong> ${event.time}</div>
Â  Â  Â  Â  <div class="popup-detail-item"><strong>ğŸ“ Location:</strong> ${event.location}</div>
Â  Â  Â  Â  <div class="popup-detail-item"><strong>ğŸ·ï¸ Category:</strong> ${event.category}</div>
Â  Â  Â  `;
Â  Â  Â  
Â  Â  Â  document.getElementById('popupDescription').textContent = event.description;

Â  Â  Â  popup.classList.add('active');
Â  Â  Â  overlay.classList.add('active');
Â  Â  }

Â  Â  function closePopup() {
Â  Â  Â  document.getElementById('eventPopup').classList.remove('active');
Â  Â  Â  document.getElementById('popupOverlay').classList.remove('active');
Â  Â  }

Â  Â  function scrollToEvent(event) {
Â  Â  Â  closePopup();
Â  Â  Â  const isUpcoming = event.status === 'upcoming'; // Rely on the accurate status
Â  Â  Â  const sectionId = isUpcoming ? 'upcomingEventsContainer' : 'pastEventsContainer';
Â  Â  Â  const section = document.getElementById(sectionId).closest('.events-section');
Â  Â  Â  
Â  Â  Â  section.scrollIntoView({ behavior: 'smooth', block: 'start' });
Â  Â  Â  
Â  Â  Â  setTimeout(() => showEventDetails(event), 500);
Â  Â  }

Â  Â  document.getElementById('prevMonth').addEventListener('click', () => {
Â  Â  Â  currentMonth--;
Â  Â  Â  if (currentMonth < 0) {
Â  Â  Â  Â  currentMonth = 11;
Â  Â  Â  Â  currentYear--;
Â  Â  Â  }
Â  Â  Â  renderCalendar();
Â  Â  });

Â  Â  document.getElementById('nextMonth').addEventListener('click', () => {
Â  Â  Â  currentMonth++;
Â  Â  Â  if (currentMonth > 11) {
Â  Â  Â  Â  currentMonth = 0;
Â  Â  Â  Â  currentYear++;
Â  Â  Â  }
Â  Â  Â  renderCalendar();
Â  Â  });

Â  Â  document.getElementById('popupClose').addEventListener('click', closePopup);
Â  Â  document.getElementById('popupOverlay').addEventListener('click', closePopup);
Â  Â  document.getElementById('carouselPrev').addEventListener('click', prevSlide);
Â  Â  document.getElementById('carouselNext').addEventListener('click', nextSlide);

Â  Â  // Auto-advance carousel every 5 seconds
Â  Â  setInterval(nextSlide, 5000);

Â  Â  async function onConfigChange(config) {
Â  Â  Â  const customFont = config.font_family || defaultConfig.font_family;
Â  Â  Â  const baseFontStack = 'serif';
Â  Â  Â  const baseSize = config.font_size || defaultConfig.font_size;
Â  Â  Â  
Â  Â  Â  document.body.style.fontFamily = `${customFont}, ${baseFontStack}`;
Â  Â  Â  document.body.style.fontSize = `${baseSize}px`;
Â  Â  Â  document.body.style.backgroundColor = config.background_color || defaultConfig.background_color;
Â  Â  Â  document.body.style.color = config.text_color || defaultConfig.text_color;
Â  Â  Â  
Â  Â  Â  document.getElementById('pageTitle').textContent = config.page_title || defaultConfig.page_title;
Â  Â  Â  document.getElementById('pageSubtitle').textContent = config.page_subtitle || defaultConfig.page_subtitle;
Â  Â  Â  document.getElementById('featuredSectionTitle').textContent = config.featured_section_title || defaultConfig.featured_section_title;
Â  Â  Â  document.getElementById('upcomingSectionTitle').textContent = config.upcoming_section_title || defaultConfig.upcoming_section_title;
Â  Â  Â  document.getElementById('pastSectionTitle').textContent = config.past_section_title || defaultConfig.past_section_title;

Â  Â  Â  const pageHeader = document.querySelector('.page-header');
Â  Â  Â  pageHeader.style.background = `linear-gradient(135deg, ${config.primary_action_color || defaultConfig.primary_action_color} 0%, ${config.secondary_action_color || defaultConfig.secondary_action_color} 100%)`;

Â  Â  Â  const logo = document.querySelector('.logo');
Â  Â  Â  logo.style.color = config.primary_action_color || defaultConfig.primary_action_color;

Â  Â  Â  const navLinks = document.querySelectorAll('.nav-links a');
Â  Â  Â  navLinks.forEach(link => {
Â  Â  Â  Â  link.style.color = config.text_color || defaultConfig.text_color;
Â  Â  Â  });

Â  Â  Â  const sectionTitles = document.querySelectorAll('.section-title, .calendar-title, .current-month');
Â  Â  Â  sectionTitles.forEach(title => {
Â  Â  Â  Â  title.style.color = config.primary_action_color || defaultConfig.primary_action_color;
Â  Â  Â  });
Â  Â  }

Â  Â  if (window.elementSdk) {
Â  Â  Â  window.elementSdk.init({
Â  Â  Â  Â  defaultConfig,
Â  Â  Â  Â  onConfigChange,
Â  Â  Â  Â  mapToCapabilities: (config) => ({
Â  Â  Â  Â  Â  recolorables: [
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  get: () => config.background_color || defaultConfig.background_color,
Â  Â  Â  Â  Â  Â  Â  set: (value) => {
Â  Â  Â  Â  Â  Â  Â  Â  config.background_color = value;
Â  Â  Â  Â  Â  Â  Â  Â  window.elementSdk.setConfig({ background_color: value });
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  get: () => config.surface_color || defaultConfig.surface_color,
Â  Â  Â  Â  Â  Â  Â  set: (value) => {
Â  Â  Â  Â  Â  Â  Â  Â  config.surface_color = value;
Â  Â  Â  Â  Â  Â  Â  Â  window.elementSdk.setConfig({ surface_color: value });
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  get: () => config.text_color || defaultConfig.text_color,
Â  Â  Â  Â  Â  Â  Â  set: (value) => {
Â  Â  Â  Â  Â  Â  Â  Â  config.text_color = value;
Â  Â  Â  Â  Â  Â  Â  Â  window.elementSdk.setConfig({ text_color: value });
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  get: () => config.primary_action_color || defaultConfig.primary_action_color,
Â  Â  Â  Â  Â  Â  Â  set: (value) => {
Â  Â  Â  Â  Â  Â  Â  Â  config.primary_action_color = value;
Â  Â  Â  Â  Â  Â  Â  Â  window.elementSdk.setConfig({ primary_action_color: value });
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  Â  {
Â  Â  Â  Â  Â  Â  Â  get: () => config.secondary_action_color || defaultConfig.secondary_action_color,
Â  Â  Â  Â  Â  Â  Â  set: (value) => {
Â  Â  Â  Â  Â  Â  Â  Â  config.secondary_action_color = value;
Â  Â  Â  Â  Â  Â  Â  Â  window.elementSdk.setConfig({ secondary_action_color: value });
Â  Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  ],
Â  Â  Â  Â  Â  borderables: [],
Â  Â  Â  Â  Â  fontEditable: {
Â  Â  Â  Â  Â  Â  get: () => config.font_family || defaultConfig.font_family,
Â  Â  Â  Â  Â  Â  set: (value) => {
Â  Â  Â  Â  Â  Â  Â  config.font_family = value;
Â  Â  Â  Â  Â  Â  Â  window.elementSdk.setConfig({ font_family: value });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  },
Â  Â  Â  Â  Â  fontSizeable: {
Â  Â  Â  Â  Â  Â  get: () => config.font_size || defaultConfig.font_size,
Â  Â  Â  Â  Â  Â  set: (value) => {
Â  Â  Â  Â  Â  Â  Â  config.font_size = value;
Â  Â  Â  Â  Â  Â  Â  window.elementSdk.setConfig({ font_size: value });
Â  Â  Â  Â  Â  Â  }
Â  Â  Â  Â  Â  }
Â  Â  Â  Â  }),
Â  Â  Â  Â  mapToEditPanelValues: (config) => new Map([
Â  Â  Â  Â  Â  ["page_title", config.page_title || defaultConfig.page_title],
Â  Â  Â  Â  Â  ["page_subtitle", config.page_subtitle || defaultConfig.page_subtitle],
Â  Â  Â  Â  Â  ["featured_section_title", config.featured_section_title || defaultConfig.featured_section_title],
Â  Â  Â  Â  Â  ["upcoming_section_title", config.upcoming_section_title || defaultConfig.upcoming_section_title],
Â  Â  Â  Â  Â  ["past_section_title", config.past_section_title || defaultConfig.past_section_title]
Â  Â  Â  Â  ])
Â  Â  Â  });
Â  Â  }

Â  Â  async function initializePage() {
Â  Â  Â  Â  // 1. Fetch the data and WAIT for it to complete
Â  Â  Â  Â  await fetchEventsFromCMS(); 
Â  Â  Â  Â  
Â  Â  Â  Â  // 2. Once eventsData is populated, render all components
Â  Â  Â  Â  renderCalendar();
Â  Â  Â  Â  renderFeaturedEvents();
Â  Â  Â  Â  renderEvents();
Â  Â  Â  Â  initCarousel();
Â  Â  }

Â  Â  initializePage();
Â  </script>
 <script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'9a65075a72ce93d1',t:'MTc2NDQ0OTk2NS4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>